<!-- TOPBAR -->
<div class="topbar">
  <button class="hamburger-btn" (click)="toggleMenu($event)">☰</button>
  <h1 class="top-title">{{ title }} ({{ headingCount }})</h1>
</div>

<div class="page-container">

  <!-- SIDEBAR -->
  <aside class="sidebar" [class.open]="isMenuOpen">

    <button class="sidebar-item"
            [class.active]="selectedStyleId === null"
            (click)="loadAllProducts()">
      All
    </button>

    <button *ngFor="let item of sidebarItems"
            class="sidebar-item"
            [class.active]="selectedStyleId === item.styleId"
            (click)="selectStyle(item)">
      {{ item.name }}
    </button>

    <button class="sidebar-item add-style-btn"
            (click)="showAddStyle = !showAddStyle">
      + Add Style
    </button>

    <div *ngIf="showAddStyle" class="add-style-box">
      <input
        type="text"
        [(ngModel)]="newStyle"
        placeholder="Enter style name" />

      <!-- ✅ FIX: hook Add button -->
      <button class="sidebar-item" (click)="addStyle()">Add</button>
    </div>

  </aside>

  <!-- MAIN CONTENT -->
  <div class="content">
    <div class="cards-grid">

      <div class="product-card" *ngFor="let product of products">

        <div class="low-stock" *ngIf="isLowStock(product)">Low Stock</div>

        <div class="image-box">
          <img [src]="product.imageUrl" [alt]="product.productName" />
        </div>

        <div class="info">

          <div class="name-row">
            <span class="name">{{ product.productName }}</span>
            <span class="menu-dots" (click)="openMenu(product)">⋮</span>

            <div class="menu-popup" *ngIf="activeMenu === product">
              <button (click)="openUpdatePrice(product)">Update Price</button>
            </div>
          </div>

          <div class="price-row">
            <span class="label">Price:</span>
            <span class="price">₹ {{ product.price }}</span>
          </div>

          <div class="size-row">
            <span class="label">Size:</span>
            <div class="size-options">
              <div class="size-circle"
                   *ngFor="let size of sizes"
                   [class.selected]="isSizeSelected(product.productId, size)"
                   (click)="selectSize(product.productId, size)">
                {{ size }}
              </div>
            </div>
          </div>

          <button class="add-cart-btn">
            Quantity: {{ getQuantity(product) }}
          </button>

        </div>
      </div>

    </div>
  </div>
</div>

<!-- UPDATE PRICE MODAL -->
<div class="update-modal" *ngIf="editingProduct">
  <div class="update-box">

    <h3>Update Price</h3>

    <div class="image-box">
      <img [src]="editingProduct.imageUrl"
           [alt]="editingProduct.productName" />
    </div>

    <label>New Price</label>
    <input type="number" [(ngModel)]="newPrice" />

    <div class="update-actions">
      <button class="add-cart-btn" (click)="updatePrice()">Update</button>
      <button class="add-cart-btn cancel" (click)="editingProduct = null">
        Cancel
      </button>
    </div>

  </div>
</div>
